function init(){resize(),hour(),setInterval(hour,1e3),$('[data-toggle="tooltip"]').tooltip(),countdown(),created(),splitPost(),growTextarea(),flashMessage(),notifs(),chat(),search_ajax(),like_ajax(),$('input[type="file"]').change(function(){var a=$(this).val();$(".file-text").html(a)})}function resize(){fullHeight("aside","min")}function fullHeight(a,n){var e=$(document).height();n?$(a).css("min-height",e):$(a).css("height",e)}function hour(){var a=moment().format("H:mm:ss");$(".sideTimer").html(a)}function countdown(){$("[data-countdown]").each(function(){var a=$(this),n=$(this).data("countdown");$(a).countdown(n,function(n){var e=n.strftime("%-D"),s=n.strftime("%H");if(0!=e)var e="24";var s=parseInt(e)+parseInt(s);if("10">s)var s="0"+s;var t=n.strftime(s+":%M:%S");$(a).html(t),"00:00:00"==t&&$(a).parents(".post").hasClass("post-split")&&$(a).delay(1e5).parents(".column-item").slideUp(500,function(){$(this).remove()})})})}function created(){$("[data-created]").each(function(){moment.locale("fr");var a=$(this).data("created"),a=moment(a,"YYYY/MM/DD H:m:s").fromNow();$(this).html(a)})}function splitPost(){$(".post-split").each(function(){var a=$(this).find(".content").text(),n=150;a.length>n&&(a=a.substring(0,n),$(this).find(".content").html(a+" [...]"))})}function growTextarea(){$("textarea.grow").click(function(){var a=$(this).data("open"),n=$(this);0==a&&($(n).stop().animate({"min-height":"10rem"}),$(n).data("open",!0))}),$("*").click(function(a){if(!$(a.target).is("textarea.grow")){var n=$("textarea.grow"),e=$(n).data("open");1==e&&$(n).val()<1&&($(n).stop().animate({"min-height":"3.4rem"}),$(n).data("open",!1))}})}function flashMessage(){$(".flash").hide().fadeIn("slow").delay(5e3).fadeOut("slow",function(){$("ul.flash").remove()}),$(".flash-close").click(function(){return $(this).parent().fadeOut("slow",function(){$("ul.flash").remove()}),!1})}function notifs(){$(".notif-icon").click(function(){var a=$(".notif-alert ul").data("open");return 0==a?($(".notif-alert ul").fadeIn(),$(".notif-alert ul").data("open",!0)):($(".notif-alert ul").fadeOut(),$(".notif-alert ul").data("open",!1)),!1}),$("*").click(function(a){if(!$(a.target).is(".notif-alert *")){var n=$(".notif-alert ul").data("open");1==n&&($(".notif-alert ul").fadeOut(),$(".notif-alert ul").data("open",!1))}})}function chat(){$(".chat").each(function(){var a=$(this),n=$(a).data("open");0==n&&$(a).find(".chat-close").hide()}),$(document).on("click",".chat .chat-header a",function(){var a=$(this),n=$(a).parents(".chat").data("open");return 1==n?$(a).parents(".chat").data("open",!1).find(".chat-close").hide():$(a).parents(".chat").data("open",!0).find(".chat-close").show(),!1}),$(document).on("click",".chat .chat-header .icon-close",function(){return $(this).parents(".chat").remove(),!1}),$(document).on("click",".chat-btn",function(){return $(".flash").remove(),$("body").prepend('\n			<ul class="flash">\n			<li class="flash-error"><span class="flash-icon"><span class="icon-close"></span></span>\n			Fonctionnalité à venir\n			<a href="#" class="flash-close"><span class="icon-close"></span></a>\n			</li>\n			</ul>\n		'),flashMessage(),!1})}function search_ajax(){$("#form_recherche input").val(""),$("#form_recherche").submit(function(){$(this).find("input"),$(this);$("#form_recherche .icon-loading").show(),$.ajax({url:$(this).attr("action"),data:{term:$(this).find("input").val()},dataType:"json",success:function(a){$("#form_recherche .icon-loading").hide(),$(".searchFriends").html(""),a.length>3?$("#btn-more-search").css("display","inline-block").attr("href",a[0].urlMore):$("#btn-more-search").hide(),$.each(a,function(n){3>n&&$(".searchFriends").append("<li><a href='"+a[n].url+"' title='"+a[n].username+"'><img src='"+a[n].image+"' alt='"+a[n].username+"' title='"+a[n].username+"' class='img-profil' />"+a[n].username+"</a><a href='#' class='chat-btn' data-username='"+a[n].username+"'><span class='icon-comment'></span></a></li>")})}})}),$("#form_recherche").submit(function(){return!1})}function like_ajax(){$(document).on("click",".likes",function(){var a=$(this),n=$(a).attr("data-asLiked"),e=$(a).attr("href");return $.ajax("false"==n?{url:e,dataType:"json",success:function(n){if("false"==n[0].success)$(".flash").remove(),$("body").prepend('\n							<ul class="flash">\n							<li class="flash-error"><span class="flash-icon"><span class="icon-close"></span></span>\n							Une erreur est survenue\n							<a href="#" class="flash-close"><span class="icon-close"></span></a>\n							</li>\n							</ul>\n						'),flashMessage();else{$(".flash").remove(),$("body").prepend('\n							<ul class="flash">\n							<li class="flash-success"><span class="flash-icon"><span class="icon-success"></span></span>\n							Vous aimez ce post\n							<a href="#" class="flash-close"><span class="icon-close"></span></a>\n							</li>\n							</ul>\n						'),flashMessage();var e=$(a).find(".like-nb").html();$(a).attr("data-asliked",!0).attr("data-original-title","Retirer le like").find(".icon-heart-empty").removeClass("icon-heart-empty").addClass("icon-heart").next(".like-nb").html(parseInt(e)+1)}}}:{url:e,dataType:"json",success:function(n){if("false"==n[0].success)$(".flash").remove(),$("body").prepend('\n							<ul class="flash">\n							<li class="flash-error"><span class="flash-icon"><span class="icon-close"></span></span>\n							Une erreur est survenue\n							<a href="#" class="flash-close"><span class="icon-close"></span></a>\n							</li>\n							</ul>\n						'),flashMessage();else{$(".flash").remove(),$("body").prepend('\n							<ul class="flash">\n							<li class="flash-warning"><span class="flash-icon"><span class="icon-notif"></span></span>\n							Vous n\'aimez plus ce post\n							<a href="#" class="flash-close"><span class="icon-close"></span></a>\n							</li>\n							</ul>\n						'),flashMessage();var e=$(a).find(".like-nb").html();$(a).attr("data-asliked",!1).attr("data-original-title","Ajouter un like").find(".icon-heart").removeClass("icon-heart").addClass("icon-heart-empty").next(".like-nb").html(parseInt(e)-1)}}}),!1})}$(function(){init(),$(window).resize(function(){resize()})}),"#_=_"==window.location.hash&&(window.location.hash="",history.pushState("",document.title,window.location.pathname),e.preventDefault());
