function init(){resize(),hour(),setInterval(hour,1e3),$('[data-toggle="tooltip"]').tooltip(),countdown(),created(),splitPost(),growTextarea(),flashMessage(),notifs(),chat(),search_ajax(),like_ajax(),add_post(),$('input[type="file"]').change(function(){var a=$(this).val();$(".file-text").html(a)})}function resize(){fullHeight("aside","min")}function fullHeight(a,e){var n=$(document).height();e?$(a).css("min-height",n):$(a).css("height",n)}function hour(){var a=moment().format("H:mm:ss");$(".sideTimer").html(a)}function countdown(){$("[data-countdown]").each(function(){var a=$(this),e=$(this).data("countdown");$(a).countdown(e,function(e){var n=e.strftime("%-D"),s=e.strftime("%H");if(0!=n)var n="24";var s=parseInt(n)+parseInt(s);if("10">s)var s="0"+s;var t=e.strftime(s+":%M:%S");$(a).html(t),"00:00:00"==t&&$(a).parents(".post").hasClass("post-split")&&$(a).delay(1e5).parents(".column-item").slideUp(500,function(){$(this).remove()})})})}function created(){$("[data-created]").each(function(){moment.locale("fr");var a=$(this).data("created"),a=moment(a,"YYYY/MM/DD H:m:s").fromNow();$(this).html(a)})}function splitPost(){$(".post-split").each(function(){var a=$(this).find(".content").text(),e=150;a.length>e&&(a=a.substring(0,e),$(this).find(".content").html(a+" [...]"))})}function growTextarea(){$("textarea.grow").click(function(){var a=$(this).data("open"),e=$(this);0==a&&($(e).stop().animate({"min-height":"10rem"}),$(e).data("open",!0))}),$("*").click(function(a){if(!$(a.target).is("textarea.grow")){var e=$("textarea.grow"),n=$(e).data("open");1==n&&$(e).val()<1&&($(e).stop().animate({"min-height":"3.4rem"}),$(e).data("open",!1))}})}function flashMessage(){$(".flash").hide().fadeIn("slow").delay(5e3).fadeOut("slow",function(){$("ul.flash").remove()}),$(".flash-close").click(function(){return $(this).parent().fadeOut("slow",function(){$("ul.flash").remove()}),!1})}function notifs(){$(".notif-icon").click(function(){var a=$(".notif-alert ul").data("open");return 0==a?($(".notif-alert ul").fadeIn(),$(".notif-alert ul").data("open",!0)):($(".notif-alert ul").fadeOut(),$(".notif-alert ul").data("open",!1)),!1}),$("*").click(function(a){if(!$(a.target).is(".notif-alert *")){var e=$(".notif-alert ul").data("open");1==e&&($(".notif-alert ul").fadeOut(),$(".notif-alert ul").data("open",!1))}})}function chat(){$(".chat").each(function(){var a=$(this),e=$(a).data("open");0==e&&$(a).find(".chat-close").hide()}),$(document).on("click",".chat .chat-header a",function(){var a=$(this),e=$(a).parents(".chat").data("open");return 1==e?$(a).parents(".chat").data("open",!1).find(".chat-close").hide():$(a).parents(".chat").data("open",!0).find(".chat-close").show(),!1}),$(document).on("click",".chat .chat-header .icon-close",function(){return $(this).parents(".chat").remove(),!1}),$(document).on("click",".chat-btn",function(){return $(".flash").remove(),$("body").prepend('\n			<ul class="flash">\n			<li class="flash-error"><span class="flash-icon"><span class="icon-close"></span></span>\n			Fonctionnalité à venir\n			<a href="#" class="flash-close"><span class="icon-close"></span></a>\n			</li>\n			</ul>\n		'),flashMessage(),!1})}function search_ajax(){$("#form_recherche input").val(""),$("#form_recherche").submit(function(){$(this).find("input"),$(this);$("#form_recherche .icon-loading").show(),$.ajax({url:$(this).attr("action"),data:{term:$(this).find("input").val()},dataType:"json",success:function(a){$("#form_recherche .icon-loading").hide(),$(".searchFriends").html(""),a.length>3?$("#btn-more-search").css("display","inline-block").attr("href",a[0].urlMore):$("#btn-more-search").hide(),""==a?$(".searchFriends").append('<li style="padding:1rem 2rem">Aucun résultat</li>'):$.each(a,function(e){3>e&&$(".searchFriends").append("<li><a href='"+a[e].url+"' title='"+a[e].username+"'><img src='"+a[e].image+"' alt='"+a[e].username+"' title='"+a[e].username+"' class='img-profil' />"+a[e].username+"</a><a href='#' class='chat-btn' data-username='"+a[e].username+"'><span class='icon-comment'></span></a></li>")})}})}),$("#form_recherche").submit(function(){return!1})}function like_ajax(){$(document).on("click",".likes",function(){var a=$(this),e=$(a).attr("data-asLiked"),n=$(a).attr("href");return $.ajax("false"==e?{url:n,dataType:"json",success:function(e){if("false"==e[0].success)$(".flash").remove(),$("body").prepend('\n							<ul class="flash">\n							<li class="flash-error"><span class="flash-icon"><span class="icon-close"></span></span>\n							Une erreur est survenue\n							<a href="#" class="flash-close"><span class="icon-close"></span></a>\n							</li>\n							</ul>\n						'),flashMessage();else{$(".flash").remove(),$("body").prepend('\n							<ul class="flash">\n							<li class="flash-success"><span class="flash-icon"><span class="icon-success"></span></span>\n							Vous aimez ce post\n							<a href="#" class="flash-close"><span class="icon-close"></span></a>\n							</li>\n							</ul>\n						'),flashMessage();var n=$(a).find(".like-nb").html();$(a).attr("data-asliked",!0).attr("data-original-title","Retirer le like").find(".icon-heart-empty").removeClass("icon-heart-empty").addClass("icon-heart").next(".like-nb").html(parseInt(n)+1)}}}:{url:n,dataType:"json",success:function(e){if("false"==e[0].success)$(".flash").remove(),$("body").prepend('\n							<ul class="flash">\n							<li class="flash-error"><span class="flash-icon"><span class="icon-close"></span></span>\n							Une erreur est survenue\n							<a href="#" class="flash-close"><span class="icon-close"></span></a>\n							</li>\n							</ul>\n						'),flashMessage();else{$(".flash").remove(),$("body").prepend('\n							<ul class="flash">\n							<li class="flash-warning"><span class="flash-icon"><span class="icon-notif"></span></span>\n							Vous n\'aimez plus ce post\n							<a href="#" class="flash-close"><span class="icon-close"></span></a>\n							</li>\n							</ul>\n						'),flashMessage();var n=$(a).find(".like-nb").html();$(a).attr("data-asliked",!1).attr("data-original-title","Ajouter un like").find(".icon-heart").removeClass("icon-heart").addClass("icon-heart-empty").next(".like-nb").html(parseInt(n)-1)}}}),!1})}function add_post(){$('form[name="erazr_bundle_sitebundle_post"]').submit(function(){""==$("#erazr_bundle_sitebundle_post_timer_minute").val()&&""!=$("#erazr_bundle_sitebundle_post_timer_hour").val()&&$("#erazr_bundle_sitebundle_post_timer_minute").val("00")})}$(function(){init(),$(window).resize(function(){resize()})}),"#_=_"==window.location.hash&&(window.location.hash="",history.pushState("",document.title,window.location.pathname),e.preventDefault());
