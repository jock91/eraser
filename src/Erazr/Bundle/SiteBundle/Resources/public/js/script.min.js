function init(){resize(),hour(),setInterval(hour,1e3),$('[data-toggle="tooltip"]').tooltip(),countdown(),created(),splitPost(),growTextarea(),flashMessage(),notifs(),chat(),search_ajax(),like_ajax()}function resize(){fullHeight("aside","min")}function fullHeight(a,t){var e=$(document).height();t?$(a).css("min-height",e):$(a).css("height",e)}function hour(){var a=moment().format("H:mm:ss");$(".sideTimer").html(a)}function countdown(){$("[data-countdown]").each(function(){var a=$(this),t=$(this).data("countdown");$(a).countdown(t,function(t){var e=t.strftime("%-D"),n=t.strftime("%H");if(0!=e)var e="24";var n=parseInt(e)+parseInt(n);if("10">n)var n="0"+n;var s=t.strftime(n+":%M:%S");$(a).html(s),"00:00:00"==s&&$(a).parents(".post").hasClass("post-split")&&$(a).delay(1e5).parents(".column-item").slideUp(500,function(){$(this).remove()})})})}function created(){$("[data-created]").each(function(){moment.locale("fr");var a=$(this).data("created"),a=moment(a,"YYYY/MM/DD H:m:s").fromNow();$(this).html(a)})}function splitPost(){$(".post-split").each(function(){var a=$(this).find(".content").text(),t=150;a.length>t&&(a=a.substring(0,t),$(this).find(".content").html(a+" [...]"))})}function growTextarea(){$("textarea.grow").click(function(){var a=$(this).data("open"),t=$(this);0==a&&($(t).stop().animate({"min-height":"10rem"}),$(t).data("open",!0))}),$("*").click(function(a){if(!$(a.target).is("textarea.grow")){var t=$("textarea.grow"),e=$(t).data("open");1==e&&$(t).val()<1&&($(t).stop().animate({"min-height":"3.4rem"}),$(t).data("open",!1))}})}function flashMessage(){$(".flash").hide().fadeIn("slow").delay(5e3).fadeOut("slow",function(){$("ul.flash").remove()}),$(".flash-close").click(function(){return $(this).parent().fadeOut("slow",function(){$("ul.flash").remove()}),!1})}function notifs(){$(".notif-icon").click(function(){var a=$(".notif-alert ul").data("open");return 0==a?($(".notif-alert ul").fadeIn(),$(".notif-alert ul").data("open",!0)):($(".notif-alert ul").fadeOut(),$(".notif-alert ul").data("open",!1)),!1}),$("*").click(function(a){if(!$(a.target).is(".notif-alert *")){var t=$(".notif-alert ul").data("open");1==t&&($(".notif-alert ul").fadeOut(),$(".notif-alert ul").data("open",!1))}})}function chat(){$(".chat").each(function(){var a=$(this),t=$(a).data("open");0==t&&$(a).find(".chat-close").hide()}),$(document).on("click",".chat .chat-header a",function(){var a=$(this),t=$(a).parents(".chat").data("open");return 1==t?$(a).parents(".chat").data("open",!1).find(".chat-close").hide():$(a).parents(".chat").data("open",!0).find(".chat-close").show(),!1}),$(document).on("click",".chat .chat-header .icon-close",function(){return $(this).parents(".chat").remove(),!1}),$(document).on("click",".chat-btn",function(){var a=$(this).data("username"),t=$('.chat[data-username="'+a+'"]');if(2==$(".chat").length&&0==$(t).length)$("body").prepend('\n				<ul class="flash">\n				<li class="flash-error"><span class="flash-icon"><span class="icon-close"></span></span>\n				Vous ne pouvez avoir que 2 chat d\'ouvert simultanement\n				<a href="#" class="flash-close"><span class="icon-close"></span></a>\n				</li>\n				</ul>\n			'),flashMessage();else if($(t).length>0){var e=$(t).data("open");0==e&&$(t).data("open",!0).find(".chat-close").show()}else $(".chat-container").append("<div class='chat' data-username="+a+" data-open='true'><div><div class='chat-header'><a href='#'>"+a+"<span class='icon-close'></span></a></div><div class='chat-close chat-content'></div><div class='chat-close chat-footer'><form><input type='text' placeholder='Ecrire un message' class='form-control' /></form></div></div>");return!1})}function search_ajax(){$("#form_recherche input").val(""),$("#form_recherche").submit(function(){$(this).find("input"),$(this);$("#form_recherche .icon-loading").show(),$.ajax({url:$(this).attr("action"),data:{term:$(this).find("input").val()},dataType:"json",success:function(a){$("#form_recherche .icon-loading").hide(),$(".searchFriends").html(""),a.length>3?$("#btn-more-search").css("display","inline-block").attr("href",a[0].urlMore):$("#btn-more-search").hide(),$.each(a,function(t){3>t&&$(".searchFriends").append("<li><a href='"+a[t].url+"' title='"+a[t].username+"'><img src='/bundles/erazrsite/img/profil.png' alt='"+a[t].username+"' title='"+a[t].username+"' />"+a[t].username+"</a><a href='#' class='chat-btn' data-username='"+a[t].username+"'><span class='icon-comment'></span></a></li>")})}})}),$("#form_recherche").submit(function(){return!1})}function like_ajax(){$(".likes").click(function(){var a=$(this),t=$(a).attr("data-asLiked"),e=$(a).attr("href");return $.ajax("false"==t?{url:e,dataType:"json",success:function(t){"false"==t[0].error?($("body").prepend('\n							<ul class="flash">\n							<li class="flash-error"><span class="flash-icon"><span class="icon-close"></span></span>\n							'+t[0].error+'\n							<a href="#" class="flash-close"><span class="icon-close"></span></a>\n							</li>\n							</ul>\n						'),flashMessage(),$(a).attr("data-asliked",!0).attr("data-original-title","Retirer le like").find(".icon-heart-empty").removeClass(".icon-heart-empty").addClass(".icon-heart")):($("body").prepend('\n							<ul class="flash">\n							<li class="flash-success"><span class="flash-icon"><span class="icon-success"></span></span>\n							'+t[0].success+'\n							<a href="#" class="flash-close"><span class="icon-close"></span></a>\n							</li>\n							</ul>\n						'),flashMessage(),$(a).attr("data-asliked",!1).attr("data-original-title","Ajouter un like").find(".icon-heart").removeClass(".icon-heart").addClass(".icon-heart-empty"))},error:function(a,t){console.log(t)}}:{url:e,dataType:"json",success:function(a){console.log(a)},error:function(a,t){console.log(t)}}),!1})}$(function(){init(),$(window).resize(function(){resize()})}),"#_=_"==window.location.hash&&(window.location.hash="",history.pushState("",document.title,window.location.pathname),e.preventDefault());
