function init(){resize(),hour(),setInterval(hour,1e3),$('[data-toggle="tooltip"]').tooltip(),countdown(),created(),splitPost(),growTextarea(),flashMessage(),notifs(),chat(),search_ajax()}function resize(){fullHeight("aside","min")}function fullHeight(e,t){var a=$(document).height();t?$(e).css("min-height",a):$(e).css("height",a)}function hour(){var e=moment().format("H:mm:ss");$(".sideTimer").html(e)}function countdown(){$("[data-countdown]").each(function(){var e=$(this),t=$(this).data("countdown");$(e).countdown(t,function(t){var a=t.strftime("%-D"),n=t.strftime("%H");if(0!=a)var a="24";var n=parseInt(a)+parseInt(n);if("10">n)var n="0"+n;var o=t.strftime(n+":%M:%S");$(e).html(o),"00:00:00"==o&&$(e).parents(".post").hasClass("post-split")&&$(e).delay(1e5).parents(".column-item").slideUp(500,function(){$(this).remove()})})})}function created(){$("[data-created]").each(function(){moment.locale("fr");var e=$(this).data("created"),e=moment(e,"YYYY/MM/DD H:m:s").fromNow();$(this).html(e)})}function splitPost(){$(".post-split").each(function(){var e=$(this).find(".content").text(),t=150;e.length>t&&(e=e.substring(0,t),$(this).find(".content").html(e+" [...]"))})}function growTextarea(){$("textarea.grow").click(function(){var e=$(this).data("open"),t=$(this);0==e&&($(t).stop().animate({"min-height":"10rem"}),$(t).data("open",!0))}),$("*").click(function(e){if(!$(e.target).is("textarea.grow")){var t=$("textarea.grow"),a=$(t).data("open");1==a&&$(t).val()<1&&($(t).stop().animate({"min-height":"3.4rem"}),$(t).data("open",!1))}})}function flashMessage(){$(".flash").hide().fadeIn("slow").delay(5e3).fadeOut("slow",function(){$("ul.flash").remove()}),$(".flash-close").click(function(){return $(this).parent().fadeOut("slow",function(){$("ul.flash").remove()}),!1})}function notifs(){$(".notif-icon").click(function(){var e=$(".notif-alert ul").data("open");return 0==e?($(".notif-alert ul").fadeIn(),$(".notif-alert ul").data("open",!0)):($(".notif-alert ul").fadeOut(),$(".notif-alert ul").data("open",!1)),!1}),$("*").click(function(e){if(!$(e.target).is(".notif-alert *")){var t=$(".notif-alert ul").data("open");1==t&&($(".notif-alert ul").fadeOut(),$(".notif-alert ul").data("open",!1))}})}function chat(){$(".chat").each(function(){var e=$(this),t=$(e).data("open");0==t&&$(e).find(".chat-close").hide()}),$(document).on("click",".chat .chat-header a",function(){var e=$(this),t=$(e).parents(".chat").data("open");return 1==t?$(e).parents(".chat").data("open",!1).find(".chat-close").hide():$(e).parents(".chat").data("open",!0).find(".chat-close").show(),!1}),$(document).on("click",".chat .chat-header .icon-close",function(){return $(this).parents(".chat").remove(),!1}),$(".chat-btn").click(function(){var e=$(this).data("username"),t=$('.chat[data-username="'+e+'"]');if(2==$(".chat").length&&0==$(t).length)$("body").prepend('\n				<ul class="flash">\n				<li class="flash-error"><span class="flash-icon"><span class="icon-close"></span></span>\n				Vous ne pouvez avoir que 2 chat d\'ouvert simultanement\n				<a href="#" class="flash-close"><span class="icon-close"></span></a>\n				</li>\n				</ul>\n			'),flashMessage();else if($(t).length>0){var a=$(t).data("open");0==a&&$(t).data("open",!0).find(".chat-close").show()}else $(".chat-container").append("<div class='chat' data-username="+e+" data-open='true'><div><div class='chat-header'><a href='#'>"+e+"<span class='icon-close'></span></a></div><div class='chat-close chat-content'></div><div class='chat-close chat-footer'><form><input type='text' placeholder='Ecrire un message' class='form-control' /></form></div></div>");return!1})}function search_ajax(){$("#form_recherche input").keydown(function(e){{var t=$(this);$("#form_recherche")}$(t).val().length>=2&&13!=e.keyCode&&224!=e.keycode&&18!=e.keycode&&17!=e.keyCode&&($("#form_recherche .icon-loading").show(),$.ajax({url:"/app_dev.php/searchJson/"+$(t).val(),dataType:"json",success:function(e){$("#form_recherche .icon-loading").hide(),$(".searchFriends").html(""),e.length>3?$("#btn-more-search").css("display","inline-block").attr("href","/app_dev.php/search/"+$(t).val()):$("#btn-more-search").hide(),$.each(e,function(t){3>t&&($(".searchFriends").append("<li><a href='/profile/of/"+e[t].username+"' title='"+e[t].username+"'><img src='/bundles/erazrsite/img/profil.png' alt='"+e[t].username+"' title='"+e[t].username+"' />"+e[t].username+"</a><a href='#' class='chat-btn' data-username='"+e[t].username+"'><span class='icon-comment'></span></a></li>"),console.log(e[t].username))})}}))}),$("#form_recherche").submit(function(){return!1})}$(function(){init(),$(window).resize(function(){resize()})}),"#_=_"==window.location.hash&&(window.location.hash="",history.pushState("",document.title,window.location.pathname),e.preventDefault());
